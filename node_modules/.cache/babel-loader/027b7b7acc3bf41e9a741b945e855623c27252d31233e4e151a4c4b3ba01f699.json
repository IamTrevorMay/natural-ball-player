{"ast":null,"code":"var _jsxFileName = \"/Users/trevormay/Desktop/npb-portal/src/Messages.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { supabase } from './supabaseClient';\nimport { MessageSquare, Plus, Users, User, Pin, Send, X, ArrowLeft, Bell } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Messages({\n  userId,\n  userRole\n}) {\n  _s();\n  const [conversations, setConversations] = useState([]);\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [showNewMessage, setShowNewMessage] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [teams, setTeams] = useState([]);\n  const [users, setUsers] = useState([]);\n  useEffect(() => {\n    fetchConversations();\n    fetchTeams();\n    fetchUsers();\n\n    // Subscribe to real-time message updates\n    const subscription = supabase.channel('messages').on('postgres_changes', {\n      event: '*',\n      schema: 'public',\n      table: 'messages'\n    }, () => {\n      fetchConversations();\n      if (selectedConversation) {\n        fetchConversationDetail(selectedConversation.id);\n      }\n    }).subscribe();\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [userId]);\n  const fetchConversations = async () => {\n    console.log('ðŸ“¥ Fetching conversations for userId:', userId);\n\n    // Step 1: Get my conversation IDs\n    const {\n      data: participantData,\n      error: partError\n    } = await supabase.from('conversation_participants').select('conversation_id').eq('user_id', userId);\n    console.log('Step 1 - My conversation IDs:', participantData);\n    if (partError || !participantData || participantData.length === 0) {\n      console.log('No conversations found or error:', partError);\n      setConversations([]);\n      setLoading(false);\n      return;\n    }\n    const conversationIds = participantData.map(p => p.conversation_id);\n    console.log('Step 2 - IDs to fetch:', conversationIds);\n\n    // Step 2: Get conversation details\n    const {\n      data: convData,\n      error: convError\n    } = await supabase.from('conversations').select('*').in('id', conversationIds).order('updated_at', {\n      ascending: false\n    });\n    console.log('Step 3 - Conversations:', convData);\n    if (convError || !convData) {\n      console.error('Error fetching conversations:', convError);\n      setConversations([]);\n      setLoading(false);\n      return;\n    }\n\n    // Step 3: Enhance with messages and team info\n    const enhanced = await Promise.all(convData.map(async conv => {\n      // Get last message\n      const {\n        data: msgs\n      } = await supabase.from('messages').select('id, content, created_at, sender_id').eq('conversation_id', conv.id).order('created_at', {\n        ascending: false\n      }).limit(1);\n\n      // Get team name if exists\n      let teamName = null;\n      if (conv.team_id) {\n        const {\n          data: team\n        } = await supabase.from('teams').select('name').eq('id', conv.team_id).single();\n        teamName = team === null || team === void 0 ? void 0 : team.name;\n      }\n      return {\n        ...conv,\n        messages: msgs || [],\n        lastMessage: msgs === null || msgs === void 0 ? void 0 : msgs[0],\n        teams: teamName ? {\n          name: teamName\n        } : null,\n        unreadCount: 0,\n        conversation_participants: []\n      };\n    }));\n    console.log('âœ… Final conversations:', enhanced);\n    setConversations(enhanced);\n    setLoading(false);\n  };\n  const fetchTeams = async () => {\n    if (userRole === 'admin' || userRole === 'coach') {\n      const {\n        data\n      } = await supabase.from('teams').select('*').order('name');\n      if (data) setTeams(data);\n    }\n  };\n  const fetchUsers = async () => {\n    if (userRole === 'admin' || userRole === 'coach') {\n      const {\n        data\n      } = await supabase.from('users').select('id, full_name, role').order('full_name');\n      if (data) setUsers(data);\n    }\n  };\n  const fetchConversationDetail = async conversationId => {\n    console.log('ðŸ“¨ Fetching conversation detail for ID:', conversationId);\n\n    // Step 1: Get conversation\n    const {\n      data: conv,\n      error: convError\n    } = await supabase.from('conversations').select('*').eq('id', conversationId).single();\n    console.log('Step 1 - Conversation:', conv, 'error:', convError);\n    if (convError || !conv) {\n      console.error('Error fetching conversation:', convError);\n      return;\n    }\n\n    // Step 2: Get participants with user info\n    const {\n      data: participants\n    } = await supabase.from('conversation_participants').select('user_id').eq('conversation_id', conversationId);\n    console.log('Step 2 - Participants:', participants);\n\n    // Get user details for participants\n    const participantsWithUsers = [];\n    if (participants) {\n      for (const p of participants) {\n        const {\n          data: user\n        } = await supabase.from('users').select('id, full_name, role').eq('id', p.user_id).single();\n        if (user) {\n          participantsWithUsers.push({\n            user_id: p.user_id,\n            users: user\n          });\n        }\n      }\n    }\n\n    // Step 3: Get messages with sender info\n    const {\n      data: messages\n    } = await supabase.from('messages').select('*').eq('conversation_id', conversationId).order('created_at', {\n      ascending: true\n    });\n    console.log('Step 3 - Messages:', messages);\n\n    // Get sender details for each message\n    const messagesWithSenders = [];\n    if (messages) {\n      for (const msg of messages) {\n        const {\n          data: sender\n        } = await supabase.from('users').select('id, full_name, role').eq('id', msg.sender_id).single();\n        messagesWithSenders.push({\n          ...msg,\n          sender: sender || {\n            id: msg.sender_id,\n            full_name: 'Unknown',\n            role: 'unknown'\n          }\n        });\n      }\n    }\n\n    // Step 4: Get team name if exists\n    let teamData = null;\n    if (conv.team_id) {\n      const {\n        data: team\n      } = await supabase.from('teams').select('name').eq('id', conv.team_id).single();\n      teamData = team;\n    }\n    const fullConversation = {\n      ...conv,\n      conversation_participants: participantsWithUsers,\n      messages: messagesWithSenders,\n      teams: teamData\n    };\n    console.log('âœ… Full conversation:', fullConversation);\n    setSelectedConversation(fullConversation);\n\n    // Mark messages as read\n    const unreadMessages = messagesWithSenders.filter(m => m.sender_id !== userId && !m.read);\n    if (unreadMessages.length > 0) {\n      await Promise.all(unreadMessages.map(msg => supabase.from('message_reads').insert({\n        message_id: msg.id,\n        user_id: userId\n      })));\n      fetchConversations(); // Refresh to update unread counts\n    }\n  };\n  const togglePin = async (conversationId, currentPinned) => {\n    await supabase.from('conversations').update({\n      is_pinned: !currentPinned\n    }).eq('id', conversationId);\n    fetchConversations();\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center py-12\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-600\",\n        children: \"Loading messages...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-3xl font-bold text-gray-900\",\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mt-1\",\n          children: \"Team communication and announcements\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }, this), (userRole === 'admin' || userRole === 'coach') && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowNewMessage(true),\n        className: \"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(Plus, {\n          size: 18\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"New Message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-1 lg:grid-cols-3 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg shadow\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-4 border-b border-gray-200\",\n            children: /*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-gray-900\",\n              children: \"Conversations\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"divide-y divide-gray-200 max-h-[600px] overflow-y-auto\",\n            children: conversations.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"p-8 text-center text-gray-500\",\n              children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n                size: 40,\n                className: \"mx-auto mb-3 text-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 283,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: \"No messages yet\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 17\n            }, this) : conversations.map(conv => /*#__PURE__*/_jsxDEV(ConversationItem, {\n              conversation: conv,\n              isSelected: (selectedConversation === null || selectedConversation === void 0 ? void 0 : selectedConversation.id) === conv.id,\n              onClick: () => fetchConversationDetail(conv.id),\n              onTogglePin: () => togglePin(conv.id, conv.is_pinned),\n              userId: userId,\n              userRole: userRole\n            }, conv.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"lg:col-span-2\",\n        children: selectedConversation ? /*#__PURE__*/_jsxDEV(ConversationDetail, {\n          conversation: selectedConversation,\n          userId: userId,\n          userRole: userRole,\n          onBack: () => setSelectedConversation(null),\n          onRefresh: () => fetchConversationDetail(selectedConversation.id)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg shadow p-12 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(MessageSquare, {\n            size: 64,\n            className: \"mx-auto mb-4 text-gray-300\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-semibold text-gray-900 mb-2\",\n            children: \"Select a conversation\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-gray-600\",\n            children: \"Choose a conversation from the list to view messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 7\n    }, this), showNewMessage && /*#__PURE__*/_jsxDEV(NewMessageModal, {\n      teams: teams,\n      users: users,\n      userId: userId,\n      userRole: userRole,\n      onClose: () => setShowNewMessage(false),\n      onSuccess: () => {\n        setShowNewMessage(false);\n        fetchConversations();\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 256,\n    columnNumber: 5\n  }, this);\n}\n_s(Messages, \"ydjnKfcHfbFHEgAhBLBCtNvmof4=\");\n_c = Messages;\nfunction ConversationItem({\n  conversation,\n  isSelected,\n  onClick,\n  onTogglePin,\n  userId,\n  userRole\n}) {\n  const getConversationTitle = () => {\n    if (conversation.type === 'team_announcement') {\n      var _conversation$teams;\n      return `${((_conversation$teams = conversation.teams) === null || _conversation$teams === void 0 ? void 0 : _conversation$teams.name) || 'Team'} - ${conversation.title}`;\n    } else if (conversation.type === 'group') {\n      return conversation.title;\n    } else {\n      var _conversation$convers, _otherParticipant$use;\n      // Direct message - show other participant's name\n      const otherParticipant = (_conversation$convers = conversation.conversation_participants) === null || _conversation$convers === void 0 ? void 0 : _conversation$convers.find(p => p.user_id !== userId);\n      return (otherParticipant === null || otherParticipant === void 0 ? void 0 : (_otherParticipant$use = otherParticipant.users) === null || _otherParticipant$use === void 0 ? void 0 : _otherParticipant$use.full_name) || 'Direct Message';\n    }\n  };\n  const getIcon = () => {\n    if (conversation.type === 'team_announcement' || conversation.type === 'group') {\n      return /*#__PURE__*/_jsxDEV(Users, {\n        size: 16\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 14\n      }, this);\n    }\n    return /*#__PURE__*/_jsxDEV(User, {\n      size: 16\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 12\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    onClick: () => {\n      console.log('ðŸ–±ï¸ Conversation clicked:', conversation.id, conversation.title);\n      onClick();\n    },\n    className: `p-4 cursor-pointer hover:bg-gray-50 transition ${isSelected ? 'bg-blue-50 border-l-4 border-blue-600' : ''}`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-start justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-1 min-w-0\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2 mb-1\",\n          children: [getIcon(), /*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"font-semibold text-gray-900 truncate text-sm\",\n            children: getConversationTitle()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 13\n          }, this), conversation.is_pinned && /*#__PURE__*/_jsxDEV(Pin, {\n            size: 14,\n            className: \"text-orange-500 flex-shrink-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 384,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 378,\n          columnNumber: 11\n        }, this), conversation.lastMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-600 truncate\",\n          children: conversation.lastMessage.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-gray-400 mt-1\",\n          children: conversation.updated_at && new Date(conversation.updated_at).toLocaleDateString()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-end space-y-1 ml-2\",\n        children: [conversation.unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"bg-blue-600 text-white text-xs font-bold rounded-full h-5 min-w-[20px] flex items-center justify-center px-1.5\",\n          children: conversation.unreadCount\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 13\n        }, this), (userRole === 'admin' || userRole === 'coach') && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: e => {\n            e.stopPropagation();\n            onTogglePin();\n          },\n          className: \"text-gray-400 hover:text-orange-500 transition\",\n          children: /*#__PURE__*/_jsxDEV(Pin, {\n            size: 14\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 367,\n    columnNumber: 5\n  }, this);\n}\n_c2 = ConversationItem;\nfunction ConversationDetail({\n  conversation,\n  userId,\n  userRole,\n  onBack,\n  onRefresh\n}) {\n  _s2();\n  var _conversation$teams2, _conversation$convers2;\n  const [newMessage, setNewMessage] = useState('');\n  const [replyingTo, setReplyingTo] = useState(null);\n  const [sending, setSending] = useState(false);\n\n  // Check if user can reply\n  const canReply = !conversation.replies_disabled || userRole === 'admin' || userRole === 'coach';\n  const handleSend = async e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n    setSending(true);\n    const {\n      error\n    } = await supabase.from('messages').insert({\n      conversation_id: conversation.id,\n      sender_id: userId,\n      content: newMessage.trim(),\n      parent_message_id: (replyingTo === null || replyingTo === void 0 ? void 0 : replyingTo.id) || null\n    });\n    if (!error) {\n      setNewMessage('');\n      setReplyingTo(null);\n      onRefresh();\n    }\n    setSending(false);\n  };\n  const getReplies = messageId => {\n    return conversation.messages.filter(m => m.parent_message_id === messageId);\n  };\n  const topLevelMessages = conversation.messages.filter(m => !m.parent_message_id);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow flex flex-col h-[600px]\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 border-b border-gray-200 flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onBack,\n          className: \"lg:hidden text-gray-600 hover:text-gray-900\",\n          children: /*#__PURE__*/_jsxDEV(ArrowLeft, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"font-semibold text-gray-900\",\n            children: conversation.type === 'team_announcement' ? `${(_conversation$teams2 = conversation.teams) === null || _conversation$teams2 === void 0 ? void 0 : _conversation$teams2.name} - ${conversation.title}` : conversation.type === 'group' ? conversation.title : 'Direct Message'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-500\",\n            children: [((_conversation$convers2 = conversation.conversation_participants) === null || _conversation$convers2 === void 0 ? void 0 : _conversation$convers2.length) || 0, \" participants\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 458,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2\",\n        children: [conversation.type === 'team_announcement' && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium flex items-center space-x-1\",\n          children: [/*#__PURE__*/_jsxDEV(Bell, {\n            size: 12\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Announcement\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 13\n        }, this), conversation.replies_disabled && /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium\",\n          children: \"\\uD83D\\uDD12 Replies Off\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 487,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 479,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto p-4 space-y-4\",\n      children: topLevelMessages.map(message => /*#__PURE__*/_jsxDEV(MessageBubble, {\n        message: message,\n        isOwn: message.sender_id === userId,\n        onReply: canReply ? () => setReplyingTo(message) : null,\n        replies: getReplies(message.id),\n        userId: userId\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 495,\n      columnNumber: 7\n    }, this), replyingTo && canReply && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-4 py-2 bg-gray-50 border-t border-gray-200 flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-gray-600\",\n          children: \"Replying to \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 512,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: replyingTo.sender.full_name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 513,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 511,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setReplyingTo(null),\n        className: \"text-gray-400 hover:text-gray-600\",\n        children: /*#__PURE__*/_jsxDEV(X, {\n          size: 16\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 510,\n      columnNumber: 9\n    }, this), canReply ? /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSend,\n      className: \"p-4 border-t border-gray-200\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value),\n          placeholder: \"Type your message...\",\n          className: \"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: sending || !newMessage.trim(),\n          className: \"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 flex items-center space-x-2\",\n          children: /*#__PURE__*/_jsxDEV(Send, {\n            size: 18\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 535,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 border-t border-gray-200 bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-gray-600 text-center italic flex items-center justify-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDCE2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Replies are disabled for this announcement\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 548,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 546,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 455,\n    columnNumber: 5\n  }, this);\n}\n_s2(ConversationDetail, \"PN+eNgoz+GH2wVOL1ESVfRi6G9Y=\");\n_c3 = ConversationDetail;\nfunction MessageBubble({\n  message,\n  isOwn,\n  onReply,\n  replies,\n  userId\n}) {\n  var _message$sender, _message$sender2;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `flex ${isOwn ? 'justify-end' : 'justify-start'}`,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `max-w-[70%] ${isOwn ? 'items-end' : 'items-start'} flex flex-col`,\n      children: [!isOwn && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2 mb-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs font-semibold text-gray-900\",\n          children: (_message$sender = message.sender) === null || _message$sender === void 0 ? void 0 : _message$sender.full_name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500\",\n          children: (_message$sender2 = message.sender) === null || _message$sender2 === void 0 ? void 0 : _message$sender2.role\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 565,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 561,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `rounded-lg px-4 py-2 ${isOwn ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-900'}`,\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm whitespace-pre-wrap\",\n          children: message.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2 mt-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-xs text-gray-500\",\n          children: new Date(message.created_at).toLocaleTimeString([], {\n            hour: '2-digit',\n            minute: '2-digit'\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 11\n        }, this), !isOwn && onReply && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onReply,\n          className: \"text-xs text-blue-600 hover:text-blue-800\",\n          children: \"Reply\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 587,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 9\n      }, this), replies && replies.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 space-y-2 pl-4 border-l-2 border-gray-300\",\n        children: replies.map(reply => /*#__PURE__*/_jsxDEV(MessageBubble, {\n          message: reply,\n          isOwn: reply.sender_id === userId,\n          onReply: onReply,\n          userId: userId\n        }, reply.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 558,\n    columnNumber: 5\n  }, this);\n}\n_c4 = MessageBubble;\nfunction NewMessageModal({\n  teams,\n  users,\n  userId,\n  userRole,\n  onClose,\n  onSuccess\n}) {\n  _s3();\n  const [messageType, setMessageType] = useState('direct');\n  const [repliesDisabled, setRepliesDisabled] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    teamId: '',\n    recipientIds: [],\n    content: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n    try {\n      // Create conversation\n      console.log('ðŸ”· Creating conversation, type:', messageType);\n      const conversationData = {\n        type: messageType,\n        created_by: userId,\n        is_pinned: false,\n        replies_disabled: messageType !== 'direct' ? repliesDisabled : false\n      };\n      if (messageType === 'team_announcement') {\n        conversationData.title = formData.title;\n        conversationData.team_id = formData.teamId;\n      } else if (messageType === 'group') {\n        conversationData.title = formData.title;\n      }\n      console.log('ðŸ”· Conversation data:', conversationData);\n      const {\n        data: conversation,\n        error: convError\n      } = await supabase.from('conversations').insert(conversationData).select().single();\n      console.log('ðŸ”· Conversation created:', conversation, 'error:', convError);\n      if (convError) throw convError;\n\n      // Add participants\n      const participants = [];\n      if (messageType === 'team_announcement') {\n        // Get all team members\n        const {\n          data: teamMembers\n        } = await supabase.from('team_members').select('user_id').eq('team_id', formData.teamId);\n        participants.push(...teamMembers.map(tm => ({\n          conversation_id: conversation.id,\n          user_id: tm.user_id\n        })));\n\n        // Add creator if not in team\n        if (!teamMembers.some(tm => tm.user_id === userId)) {\n          participants.push({\n            conversation_id: conversation.id,\n            user_id: userId\n          });\n        }\n      } else {\n        // Direct or group - add selected recipients + creator\n        participants.push({\n          conversation_id: conversation.id,\n          user_id: userId\n        });\n        formData.recipientIds.forEach(recipientId => {\n          participants.push({\n            conversation_id: conversation.id,\n            user_id: recipientId\n          });\n        });\n      }\n      const {\n        error: participantsError\n      } = await supabase.from('conversation_participants').insert(participants);\n      if (participantsError) throw participantsError;\n\n      // Send initial message\n      const {\n        error: messageError\n      } = await supabase.from('messages').insert({\n        conversation_id: conversation.id,\n        sender_id: userId,\n        content: formData.content\n      });\n      if (messageError) throw messageError;\n      onSuccess();\n    } catch (err) {\n      setError(err.message);\n      setLoading(false);\n    }\n  };\n  const toggleRecipient = recipientId => {\n    setFormData(prev => ({\n      ...prev,\n      recipientIds: prev.recipientIds.includes(recipientId) ? prev.recipientIds.filter(id => id !== recipientId) : [...prev.recipientIds, recipientId]\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-bold text-gray-900\",\n          children: \"New Message\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 734,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"text-gray-400 hover:text-gray-600\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 736,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 735,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 733,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"p-6 space-y-4\",\n        children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 742,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Message Type *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 749,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => setMessageType('direct'),\n              className: `flex-1 py-2 px-4 rounded-lg font-medium transition ${messageType === 'direct' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              children: \"Direct Message\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 753,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => setMessageType('group'),\n              className: `flex-1 py-2 px-4 rounded-lg font-medium transition ${messageType === 'group' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              children: \"Group Chat\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 764,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => setMessageType('team_announcement'),\n              className: `flex-1 py-2 px-4 rounded-lg font-medium transition ${messageType === 'team_announcement' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`,\n              children: \"Team Announcement\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 775,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 752,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 11\n        }, this), (messageType === 'group' || messageType === 'team_announcement') && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Title *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 792,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            required: true,\n            placeholder: \"e.g., Practice Update, Game Day Info\",\n            value: formData.title,\n            onChange: e => setFormData({\n              ...formData,\n              title: e.target.value\n            }),\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 795,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 791,\n          columnNumber: 13\n        }, this), messageType === 'team_announcement' && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Team *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 809,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            required: true,\n            value: formData.teamId,\n            onChange: e => setFormData({\n              ...formData,\n              teamId: e.target.value\n            }),\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\",\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              children: \"Select team\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 818,\n              columnNumber: 17\n            }, this), teams.map(team => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: team.id,\n              children: team.name\n            }, team.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 820,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 812,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 808,\n          columnNumber: 13\n        }, this), (messageType === 'direct' || messageType === 'group') && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: [\"Recipients * \", messageType === 'direct' && '(select one)']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 829,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto space-y-2\",\n            children: users.filter(u => u.id !== userId).map(user => /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: messageType === 'direct' ? 'radio' : 'checkbox',\n                checked: formData.recipientIds.includes(user.id),\n                onChange: () => {\n                  if (messageType === 'direct') {\n                    setFormData({\n                      ...formData,\n                      recipientIds: [user.id]\n                    });\n                  } else {\n                    toggleRecipient(user.id);\n                  }\n                },\n                className: \"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 838,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm text-gray-900\",\n                children: user.full_name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 850,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-xs text-gray-500\",\n                children: [\"(\", user.role, \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 851,\n                columnNumber: 21\n              }, this)]\n            }, user.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 834,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 832,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 828,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-2\",\n            children: \"Message *\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 860,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            required: true,\n            value: formData.content,\n            onChange: e => setFormData({\n              ...formData,\n              content: e.target.value\n            }),\n            rows: \"6\",\n            placeholder: \"Type your message...\",\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 863,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 859,\n          columnNumber: 11\n        }, this), (messageType === 'team_announcement' || messageType === 'group') && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"border-t border-gray-200 pt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center space-x-3 cursor-pointer\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: repliesDisabled,\n              onChange: e => setRepliesDisabled(e.target.checked),\n              className: \"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 877,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-sm font-medium text-gray-700\",\n                children: \"Disable replies (announcement only)\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 884,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-500 mt-0.5\",\n                children: \"Players won't be able to reply. Coaches and admins can still respond.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 887,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 883,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 876,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 875,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-3 pt-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: onClose,\n            className: \"flex-1 border border-gray-300 text-gray-700 py-3 rounded-lg font-medium hover:bg-gray-50 transition\",\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 896,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: loading,\n            className: \"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition disabled:opacity-50\",\n            children: loading ? 'Sending...' : 'Send Message'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 903,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 895,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 740,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 732,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 731,\n    columnNumber: 5\n  }, this);\n}\n_s3(NewMessageModal, \"H4ykA78G6JFeaai5+caTeACsV6Y=\");\n_c5 = NewMessageModal;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"Messages\");\n$RefreshReg$(_c2, \"ConversationItem\");\n$RefreshReg$(_c3, \"ConversationDetail\");\n$RefreshReg$(_c4, \"MessageBubble\");\n$RefreshReg$(_c5, \"NewMessageModal\");","map":{"version":3,"names":["React","useState","useEffect","supabase","MessageSquare","Plus","Users","User","Pin","Send","X","ArrowLeft","Bell","jsxDEV","_jsxDEV","Messages","userId","userRole","_s","conversations","setConversations","selectedConversation","setSelectedConversation","showNewMessage","setShowNewMessage","loading","setLoading","teams","setTeams","users","setUsers","fetchConversations","fetchTeams","fetchUsers","subscription","channel","on","event","schema","table","fetchConversationDetail","id","subscribe","unsubscribe","console","log","data","participantData","error","partError","from","select","eq","length","conversationIds","map","p","conversation_id","convData","convError","in","order","ascending","enhanced","Promise","all","conv","msgs","limit","teamName","team_id","team","single","name","messages","lastMessage","unreadCount","conversation_participants","conversationId","participants","participantsWithUsers","user","user_id","push","messagesWithSenders","msg","sender","sender_id","full_name","role","teamData","fullConversation","unreadMessages","filter","m","read","insert","message_id","togglePin","currentPinned","update","is_pinned","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","size","ConversationItem","conversation","isSelected","onTogglePin","ConversationDetail","onBack","onRefresh","NewMessageModal","onClose","onSuccess","_c","getConversationTitle","type","_conversation$teams","title","_conversation$convers","_otherParticipant$use","otherParticipant","find","getIcon","content","updated_at","Date","toLocaleDateString","e","stopPropagation","_c2","_s2","_conversation$teams2","_conversation$convers2","newMessage","setNewMessage","replyingTo","setReplyingTo","sending","setSending","canReply","replies_disabled","handleSend","preventDefault","trim","parent_message_id","getReplies","messageId","topLevelMessages","message","MessageBubble","isOwn","onReply","replies","onSubmit","value","onChange","target","placeholder","disabled","_c3","_message$sender","_message$sender2","created_at","toLocaleTimeString","hour","minute","reply","_c4","_s3","messageType","setMessageType","repliesDisabled","setRepliesDisabled","formData","setFormData","teamId","recipientIds","setError","handleSubmit","conversationData","created_by","teamMembers","tm","some","forEach","recipientId","participantsError","messageError","err","toggleRecipient","prev","includes","required","u","checked","rows","_c5","$RefreshReg$"],"sources":["/Users/trevormay/Desktop/npb-portal/src/Messages.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from './supabaseClient';\nimport { MessageSquare, Plus, Users, User, Pin, Send, X, ArrowLeft, Bell } from 'lucide-react';\n\nexport default function Messages({ userId, userRole }) {\n  const [conversations, setConversations] = useState([]);\n  const [selectedConversation, setSelectedConversation] = useState(null);\n  const [showNewMessage, setShowNewMessage] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [teams, setTeams] = useState([]);\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n    fetchConversations();\n    fetchTeams();\n    fetchUsers();\n    \n    // Subscribe to real-time message updates\n    const subscription = supabase\n      .channel('messages')\n      .on('postgres_changes', \n        { event: '*', schema: 'public', table: 'messages' }, \n        () => {\n          fetchConversations();\n          if (selectedConversation) {\n            fetchConversationDetail(selectedConversation.id);\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, [userId]);\n\n  const fetchConversations = async () => {\n    console.log('ðŸ“¥ Fetching conversations for userId:', userId);\n    \n    // Step 1: Get my conversation IDs\n    const { data: participantData, error: partError } = await supabase\n      .from('conversation_participants')\n      .select('conversation_id')\n      .eq('user_id', userId);\n\n    console.log('Step 1 - My conversation IDs:', participantData);\n\n    if (partError || !participantData || participantData.length === 0) {\n      console.log('No conversations found or error:', partError);\n      setConversations([]);\n      setLoading(false);\n      return;\n    }\n\n    const conversationIds = participantData.map(p => p.conversation_id);\n    console.log('Step 2 - IDs to fetch:', conversationIds);\n\n    // Step 2: Get conversation details\n    const { data: convData, error: convError } = await supabase\n      .from('conversations')\n      .select('*')\n      .in('id', conversationIds)\n      .order('updated_at', { ascending: false });\n\n    console.log('Step 3 - Conversations:', convData);\n\n    if (convError || !convData) {\n      console.error('Error fetching conversations:', convError);\n      setConversations([]);\n      setLoading(false);\n      return;\n    }\n\n    // Step 3: Enhance with messages and team info\n    const enhanced = await Promise.all(\n      convData.map(async (conv) => {\n        // Get last message\n        const { data: msgs } = await supabase\n          .from('messages')\n          .select('id, content, created_at, sender_id')\n          .eq('conversation_id', conv.id)\n          .order('created_at', { ascending: false })\n          .limit(1);\n\n        // Get team name if exists\n        let teamName = null;\n        if (conv.team_id) {\n          const { data: team } = await supabase\n            .from('teams')\n            .select('name')\n            .eq('id', conv.team_id)\n            .single();\n          teamName = team?.name;\n        }\n\n        return {\n          ...conv,\n          messages: msgs || [],\n          lastMessage: msgs?.[0],\n          teams: teamName ? { name: teamName } : null,\n          unreadCount: 0,\n          conversation_participants: []\n        };\n      })\n    );\n\n    console.log('âœ… Final conversations:', enhanced);\n    setConversations(enhanced);\n    setLoading(false);\n  };\n\n  const fetchTeams = async () => {\n    if (userRole === 'admin' || userRole === 'coach') {\n      const { data } = await supabase.from('teams').select('*').order('name');\n      if (data) setTeams(data);\n    }\n  };\n\n  const fetchUsers = async () => {\n    if (userRole === 'admin' || userRole === 'coach') {\n      const { data } = await supabase\n        .from('users')\n        .select('id, full_name, role')\n        .order('full_name');\n      if (data) setUsers(data);\n    }\n  };\n\n  const fetchConversationDetail = async (conversationId) => {\n    console.log('ðŸ“¨ Fetching conversation detail for ID:', conversationId);\n    \n    // Step 1: Get conversation\n    const { data: conv, error: convError } = await supabase\n      .from('conversations')\n      .select('*')\n      .eq('id', conversationId)\n      .single();\n\n    console.log('Step 1 - Conversation:', conv, 'error:', convError);\n\n    if (convError || !conv) {\n      console.error('Error fetching conversation:', convError);\n      return;\n    }\n\n    // Step 2: Get participants with user info\n    const { data: participants } = await supabase\n      .from('conversation_participants')\n      .select('user_id')\n      .eq('conversation_id', conversationId);\n\n    console.log('Step 2 - Participants:', participants);\n\n    // Get user details for participants\n    const participantsWithUsers = [];\n    if (participants) {\n      for (const p of participants) {\n        const { data: user } = await supabase\n          .from('users')\n          .select('id, full_name, role')\n          .eq('id', p.user_id)\n          .single();\n        \n        if (user) {\n          participantsWithUsers.push({\n            user_id: p.user_id,\n            users: user\n          });\n        }\n      }\n    }\n\n    // Step 3: Get messages with sender info\n    const { data: messages } = await supabase\n      .from('messages')\n      .select('*')\n      .eq('conversation_id', conversationId)\n      .order('created_at', { ascending: true });\n\n    console.log('Step 3 - Messages:', messages);\n\n    // Get sender details for each message\n    const messagesWithSenders = [];\n    if (messages) {\n      for (const msg of messages) {\n        const { data: sender } = await supabase\n          .from('users')\n          .select('id, full_name, role')\n          .eq('id', msg.sender_id)\n          .single();\n        \n        messagesWithSenders.push({\n          ...msg,\n          sender: sender || { id: msg.sender_id, full_name: 'Unknown', role: 'unknown' }\n        });\n      }\n    }\n\n    // Step 4: Get team name if exists\n    let teamData = null;\n    if (conv.team_id) {\n      const { data: team } = await supabase\n        .from('teams')\n        .select('name')\n        .eq('id', conv.team_id)\n        .single();\n      teamData = team;\n    }\n\n    const fullConversation = {\n      ...conv,\n      conversation_participants: participantsWithUsers,\n      messages: messagesWithSenders,\n      teams: teamData\n    };\n\n    console.log('âœ… Full conversation:', fullConversation);\n    setSelectedConversation(fullConversation);\n    \n    // Mark messages as read\n    const unreadMessages = messagesWithSenders.filter(m => \n      m.sender_id !== userId && !m.read\n    );\n    \n    if (unreadMessages.length > 0) {\n      await Promise.all(\n        unreadMessages.map(msg => \n          supabase.from('message_reads').insert({\n            message_id: msg.id,\n            user_id: userId\n          })\n        )\n      );\n      fetchConversations(); // Refresh to update unread counts\n    }\n  };\n\n  const togglePin = async (conversationId, currentPinned) => {\n    await supabase\n      .from('conversations')\n      .update({ is_pinned: !currentPinned })\n      .eq('id', conversationId);\n    \n    fetchConversations();\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <p className=\"text-gray-600\">Loading messages...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-3xl font-bold text-gray-900\">Messages</h2>\n          <p className=\"text-gray-600 mt-1\">Team communication and announcements</p>\n        </div>\n        {(userRole === 'admin' || userRole === 'coach') && (\n          <button\n            onClick={() => setShowNewMessage(true)}\n            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition flex items-center space-x-2\"\n          >\n            <Plus size={18} />\n            <span>New Message</span>\n          </button>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Conversations List */}\n        <div className=\"lg:col-span-1\">\n          <div className=\"bg-white rounded-lg shadow\">\n            <div className=\"p-4 border-b border-gray-200\">\n              <h3 className=\"font-semibold text-gray-900\">Conversations</h3>\n            </div>\n            <div className=\"divide-y divide-gray-200 max-h-[600px] overflow-y-auto\">\n              {conversations.length === 0 ? (\n                <div className=\"p-8 text-center text-gray-500\">\n                  <MessageSquare size={40} className=\"mx-auto mb-3 text-gray-300\" />\n                  <p>No messages yet</p>\n                </div>\n              ) : (\n                conversations.map((conv) => (\n                  <ConversationItem\n                    key={conv.id}\n                    conversation={conv}\n                    isSelected={selectedConversation?.id === conv.id}\n                    onClick={() => fetchConversationDetail(conv.id)}\n                    onTogglePin={() => togglePin(conv.id, conv.is_pinned)}\n                    userId={userId}\n                    userRole={userRole}\n                  />\n                ))\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Conversation Detail */}\n        <div className=\"lg:col-span-2\">\n          {selectedConversation ? (\n            <ConversationDetail\n              conversation={selectedConversation}\n              userId={userId}\n              userRole={userRole}\n              onBack={() => setSelectedConversation(null)}\n              onRefresh={() => fetchConversationDetail(selectedConversation.id)}\n            />\n          ) : (\n            <div className=\"bg-white rounded-lg shadow p-12 text-center\">\n              <MessageSquare size={64} className=\"mx-auto mb-4 text-gray-300\" />\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                Select a conversation\n              </h3>\n              <p className=\"text-gray-600\">\n                Choose a conversation from the list to view messages\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {showNewMessage && (\n        <NewMessageModal\n          teams={teams}\n          users={users}\n          userId={userId}\n          userRole={userRole}\n          onClose={() => setShowNewMessage(false)}\n          onSuccess={() => {\n            setShowNewMessage(false);\n            fetchConversations();\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\nfunction ConversationItem({ conversation, isSelected, onClick, onTogglePin, userId, userRole }) {\n  const getConversationTitle = () => {\n    if (conversation.type === 'team_announcement') {\n      return `${conversation.teams?.name || 'Team'} - ${conversation.title}`;\n    } else if (conversation.type === 'group') {\n      return conversation.title;\n    } else {\n      // Direct message - show other participant's name\n      const otherParticipant = conversation.conversation_participants?.find(\n        p => p.user_id !== userId\n      );\n      return otherParticipant?.users?.full_name || 'Direct Message';\n    }\n  };\n\n  const getIcon = () => {\n    if (conversation.type === 'team_announcement' || conversation.type === 'group') {\n      return <Users size={16} />;\n    }\n    return <User size={16} />;\n  };\n\n  return (\n    <div\n      onClick={() => {\n        console.log('ðŸ–±ï¸ Conversation clicked:', conversation.id, conversation.title);\n        onClick();\n      }}\n      className={`p-4 cursor-pointer hover:bg-gray-50 transition ${\n        isSelected ? 'bg-blue-50 border-l-4 border-blue-600' : ''\n      }`}\n    >\n      <div className=\"flex items-start justify-between\">\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center space-x-2 mb-1\">\n            {getIcon()}\n            <h4 className=\"font-semibold text-gray-900 truncate text-sm\">\n              {getConversationTitle()}\n            </h4>\n            {conversation.is_pinned && (\n              <Pin size={14} className=\"text-orange-500 flex-shrink-0\" />\n            )}\n          </div>\n          {conversation.lastMessage && (\n            <p className=\"text-xs text-gray-600 truncate\">\n              {conversation.lastMessage.content}\n            </p>\n          )}\n          <p className=\"text-xs text-gray-400 mt-1\">\n            {conversation.updated_at && \n              new Date(conversation.updated_at).toLocaleDateString()}\n          </p>\n        </div>\n        <div className=\"flex flex-col items-end space-y-1 ml-2\">\n          {conversation.unreadCount > 0 && (\n            <span className=\"bg-blue-600 text-white text-xs font-bold rounded-full h-5 min-w-[20px] flex items-center justify-center px-1.5\">\n              {conversation.unreadCount}\n            </span>\n          )}\n          {(userRole === 'admin' || userRole === 'coach') && (\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                onTogglePin();\n              }}\n              className=\"text-gray-400 hover:text-orange-500 transition\"\n            >\n              <Pin size={14} />\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ConversationDetail({ conversation, userId, userRole, onBack, onRefresh }) {\n  const [newMessage, setNewMessage] = useState('');\n  const [replyingTo, setReplyingTo] = useState(null);\n  const [sending, setSending] = useState(false);\n\n  // Check if user can reply\n  const canReply = !conversation.replies_disabled || userRole === 'admin' || userRole === 'coach';\n\n  const handleSend = async (e) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    setSending(true);\n    const { error } = await supabase.from('messages').insert({\n      conversation_id: conversation.id,\n      sender_id: userId,\n      content: newMessage.trim(),\n      parent_message_id: replyingTo?.id || null\n    });\n\n    if (!error) {\n      setNewMessage('');\n      setReplyingTo(null);\n      onRefresh();\n    }\n    setSending(false);\n  };\n\n  const getReplies = (messageId) => {\n    return conversation.messages.filter(m => m.parent_message_id === messageId);\n  };\n\n  const topLevelMessages = conversation.messages.filter(m => !m.parent_message_id);\n\n  return (\n    <div className=\"bg-white rounded-lg shadow flex flex-col h-[600px]\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-gray-200 flex items-center justify-between\">\n        <div className=\"flex items-center space-x-3\">\n          <button\n            onClick={onBack}\n            className=\"lg:hidden text-gray-600 hover:text-gray-900\"\n          >\n            <ArrowLeft size={20} />\n          </button>\n          <div>\n            <h3 className=\"font-semibold text-gray-900\">\n              {conversation.type === 'team_announcement' \n                ? `${conversation.teams?.name} - ${conversation.title}`\n                : conversation.type === 'group'\n                ? conversation.title\n                : 'Direct Message'\n              }\n            </h3>\n            <p className=\"text-xs text-gray-500\">\n              {conversation.conversation_participants?.length || 0} participants\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          {conversation.type === 'team_announcement' && (\n            <span className=\"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium flex items-center space-x-1\">\n              <Bell size={12} />\n              <span>Announcement</span>\n            </span>\n          )}\n          {conversation.replies_disabled && (\n            <span className=\"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium\">\n              ðŸ”’ Replies Off\n            </span>\n          )}\n        </div>\n      </div>\n\n      {/* Messages */}\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        {topLevelMessages.map((message) => (\n          <MessageBubble\n            key={message.id}\n            message={message}\n            isOwn={message.sender_id === userId}\n            onReply={canReply ? () => setReplyingTo(message) : null}\n            replies={getReplies(message.id)}\n            userId={userId}\n          />\n        ))}\n      </div>\n\n      {/* Reply indicator */}\n      {replyingTo && canReply && (\n        <div className=\"px-4 py-2 bg-gray-50 border-t border-gray-200 flex items-center justify-between\">\n          <div className=\"text-sm\">\n            <span className=\"text-gray-600\">Replying to </span>\n            <span className=\"font-medium\">{replyingTo.sender.full_name}</span>\n          </div>\n          <button\n            onClick={() => setReplyingTo(null)}\n            className=\"text-gray-400 hover:text-gray-600\"\n          >\n            <X size={16} />\n          </button>\n        </div>\n      )}\n\n      {/* Input - Show based on replies_disabled and user role */}\n      {canReply ? (\n        <form onSubmit={handleSend} className=\"p-4 border-t border-gray-200\">\n          <div className=\"flex space-x-2\">\n            <input\n              type=\"text\"\n              value={newMessage}\n              onChange={(e) => setNewMessage(e.target.value)}\n              placeholder=\"Type your message...\"\n              className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n            <button\n              type=\"submit\"\n              disabled={sending || !newMessage.trim()}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50 flex items-center space-x-2\"\n            >\n              <Send size={18} />\n            </button>\n          </div>\n        </form>\n      ) : (\n        <div className=\"p-4 border-t border-gray-200 bg-gray-50\">\n          <p className=\"text-sm text-gray-600 text-center italic flex items-center justify-center space-x-2\">\n            <span>ðŸ“¢</span>\n            <span>Replies are disabled for this announcement</span>\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction MessageBubble({ message, isOwn, onReply, replies, userId }) {\n  return (\n    <div className={`flex ${isOwn ? 'justify-end' : 'justify-start'}`}>\n      <div className={`max-w-[70%] ${isOwn ? 'items-end' : 'items-start'} flex flex-col`}>\n        {!isOwn && (\n          <div className=\"flex items-center space-x-2 mb-1\">\n            <span className=\"text-xs font-semibold text-gray-900\">\n              {message.sender?.full_name}\n            </span>\n            <span className=\"text-xs text-gray-500\">\n              {message.sender?.role}\n            </span>\n          </div>\n        )}\n        <div\n          className={`rounded-lg px-4 py-2 ${\n            isOwn\n              ? 'bg-blue-600 text-white'\n              : 'bg-gray-100 text-gray-900'\n          }`}\n        >\n          <p className=\"text-sm whitespace-pre-wrap\">{message.content}</p>\n        </div>\n        <div className=\"flex items-center space-x-2 mt-1\">\n          <span className=\"text-xs text-gray-500\">\n            {new Date(message.created_at).toLocaleTimeString([], {\n              hour: '2-digit',\n              minute: '2-digit'\n            })}\n          </span>\n          {!isOwn && onReply && (\n            <button\n              onClick={onReply}\n              className=\"text-xs text-blue-600 hover:text-blue-800\"\n            >\n              Reply\n            </button>\n          )}\n        </div>\n\n        {/* Replies */}\n        {replies && replies.length > 0 && (\n          <div className=\"mt-2 space-y-2 pl-4 border-l-2 border-gray-300\">\n            {replies.map((reply) => (\n              <MessageBubble\n                key={reply.id}\n                message={reply}\n                isOwn={reply.sender_id === userId}\n                onReply={onReply}\n                userId={userId}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction NewMessageModal({ teams, users, userId, userRole, onClose, onSuccess }) {\n  const [messageType, setMessageType] = useState('direct');\n  const [repliesDisabled, setRepliesDisabled] = useState(false);\n  const [formData, setFormData] = useState({\n    title: '',\n    teamId: '',\n    recipientIds: [],\n    content: ''\n  });\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    setError('');\n\n    try {\n      // Create conversation\n      console.log('ðŸ”· Creating conversation, type:', messageType);\n      const conversationData = {\n        type: messageType,\n        created_by: userId,\n        is_pinned: false,\n        replies_disabled: messageType !== 'direct' ? repliesDisabled : false\n      };\n\n      if (messageType === 'team_announcement') {\n        conversationData.title = formData.title;\n        conversationData.team_id = formData.teamId;\n      } else if (messageType === 'group') {\n        conversationData.title = formData.title;\n      }\n\n      console.log('ðŸ”· Conversation data:', conversationData);\n\n      const { data: conversation, error: convError } = await supabase\n        .from('conversations')\n        .insert(conversationData)\n        .select()\n        .single();\n\n      console.log('ðŸ”· Conversation created:', conversation, 'error:', convError);\n\n      if (convError) throw convError;\n\n      // Add participants\n      const participants = [];\n      \n      if (messageType === 'team_announcement') {\n        // Get all team members\n        const { data: teamMembers } = await supabase\n          .from('team_members')\n          .select('user_id')\n          .eq('team_id', formData.teamId);\n        \n        participants.push(...teamMembers.map(tm => ({\n          conversation_id: conversation.id,\n          user_id: tm.user_id\n        })));\n        \n        // Add creator if not in team\n        if (!teamMembers.some(tm => tm.user_id === userId)) {\n          participants.push({\n            conversation_id: conversation.id,\n            user_id: userId\n          });\n        }\n      } else {\n        // Direct or group - add selected recipients + creator\n        participants.push({\n          conversation_id: conversation.id,\n          user_id: userId\n        });\n        formData.recipientIds.forEach(recipientId => {\n          participants.push({\n            conversation_id: conversation.id,\n            user_id: recipientId\n          });\n        });\n      }\n\n      const { error: participantsError } = await supabase\n        .from('conversation_participants')\n        .insert(participants);\n\n      if (participantsError) throw participantsError;\n\n      // Send initial message\n      const { error: messageError } = await supabase\n        .from('messages')\n        .insert({\n          conversation_id: conversation.id,\n          sender_id: userId,\n          content: formData.content\n        });\n\n      if (messageError) throw messageError;\n\n      onSuccess();\n    } catch (err) {\n      setError(err.message);\n      setLoading(false);\n    }\n  };\n\n  const toggleRecipient = (recipientId) => {\n    setFormData(prev => ({\n      ...prev,\n      recipientIds: prev.recipientIds.includes(recipientId)\n        ? prev.recipientIds.filter(id => id !== recipientId)\n        : [...prev.recipientIds, recipientId]\n    }));\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between\">\n          <h3 className=\"text-xl font-bold text-gray-900\">New Message</h3>\n          <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600\">\n            <X size={24} />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded\">\n              {error}\n            </div>\n          )}\n\n          {/* Message Type */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Message Type *\n            </label>\n            <div className=\"flex space-x-2\">\n              <button\n                type=\"button\"\n                onClick={() => setMessageType('direct')}\n                className={`flex-1 py-2 px-4 rounded-lg font-medium transition ${\n                  messageType === 'direct'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                Direct Message\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setMessageType('group')}\n                className={`flex-1 py-2 px-4 rounded-lg font-medium transition ${\n                  messageType === 'group'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                Group Chat\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setMessageType('team_announcement')}\n                className={`flex-1 py-2 px-4 rounded-lg font-medium transition ${\n                  messageType === 'team_announcement'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                Team Announcement\n              </button>\n            </div>\n          </div>\n\n          {/* Title (for groups and announcements) */}\n          {(messageType === 'group' || messageType === 'team_announcement') && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Title *\n              </label>\n              <input\n                type=\"text\"\n                required\n                placeholder=\"e.g., Practice Update, Game Day Info\"\n                value={formData.title}\n                onChange={(e) => setFormData({...formData, title: e.target.value})}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n          )}\n\n          {/* Team selection (for announcements) */}\n          {messageType === 'team_announcement' && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Team *\n              </label>\n              <select\n                required\n                value={formData.teamId}\n                onChange={(e) => setFormData({...formData, teamId: e.target.value})}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Select team</option>\n                {teams.map(team => (\n                  <option key={team.id} value={team.id}>{team.name}</option>\n                ))}\n              </select>\n            </div>\n          )}\n\n          {/* Recipient selection (for direct and group) */}\n          {(messageType === 'direct' || messageType === 'group') && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Recipients * {messageType === 'direct' && '(select one)'}\n              </label>\n              <div className=\"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto space-y-2\">\n                {users.filter(u => u.id !== userId).map(user => (\n                  <label\n                    key={user.id}\n                    className=\"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded\"\n                  >\n                    <input\n                      type={messageType === 'direct' ? 'radio' : 'checkbox'}\n                      checked={formData.recipientIds.includes(user.id)}\n                      onChange={() => {\n                        if (messageType === 'direct') {\n                          setFormData({...formData, recipientIds: [user.id]});\n                        } else {\n                          toggleRecipient(user.id);\n                        }\n                      }}\n                      className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                    />\n                    <span className=\"text-sm text-gray-900\">{user.full_name}</span>\n                    <span className=\"text-xs text-gray-500\">({user.role})</span>\n                  </label>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Message content */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Message *\n            </label>\n            <textarea\n              required\n              value={formData.content}\n              onChange={(e) => setFormData({...formData, content: e.target.value})}\n              rows=\"6\"\n              placeholder=\"Type your message...\"\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n\n          {/* Toggle Replies Checkbox - Only for team and group messages */}\n          {(messageType === 'team_announcement' || messageType === 'group') && (\n            <div className=\"border-t border-gray-200 pt-4\">\n              <label className=\"flex items-center space-x-3 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={repliesDisabled}\n                  onChange={(e) => setRepliesDisabled(e.target.checked)}\n                  className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\n                />\n                <div>\n                  <span className=\"text-sm font-medium text-gray-700\">\n                    Disable replies (announcement only)\n                  </span>\n                  <p className=\"text-xs text-gray-500 mt-0.5\">\n                    Players won't be able to reply. Coaches and admins can still respond.\n                  </p>\n                </div>\n              </label>\n            </div>\n          )}\n\n          <div className=\"flex space-x-3 pt-4\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 border border-gray-300 text-gray-700 py-3 rounded-lg font-medium hover:bg-gray-50 transition\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"flex-1 bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition disabled:opacity-50\"\n            >\n              {loading ? 'Sending...' : 'Send Message'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}